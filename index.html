<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Carte Freebord</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    #map { height: 100vh; }
  </style>
</head>
<body>
<div id="map"></div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  // Création de la carte
  var map = L.map('map').setView([46.51395, 6.61827], 15);

  // Fond de carte OpenStreetMap
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
  }).addTo(map);

  // Données spots
  var spots = [
    {
      nom: "Les Bains",
      difficulte: "rouge",
      bitume: 4,
      trafic: 3,
      coordinates: [
        [46.51395,6.61827],[46.5139,6.61824],[46.51385,6.61822],[46.51332,6.61796],[46.51232,6.61746],
        [46.512,6.61732],[46.51192,6.61724],[46.51191,6.61723],[46.51187,6.61719],[46.51185,6.61716],[46.51183,6.61714]
      ]
    }
  ];

  // Objet pour stocker les tracés affichés
  var polylines = {};

  // Ajout des markers
  spots.forEach(function(spot, index){
    var marker = L.marker(spot.coordinates[0]).addTo(map);
    marker.bindPopup(
      "<b>" + spot.nom + "</b><br>" +
      "Difficulté: " + spot.difficulte + "<br>" +
      "Bitume: " + spot.bitume + "<br>" +
      "Trafic: " + spot.trafic
    );

    // Gestion clic pour afficher/masquer le tracé
    marker.on('click', function(){
      if(polylines[index]){
        map.removeLayer(polylines[index]); // Supprime le tracé si déjà affiché
        delete polylines[index];
      } else {
        polylines[index] = L.polyline(spot.coordinates, {color: spot.difficulte}).addTo(map);
      }
    });
  });
</script>
</body>
</html>
